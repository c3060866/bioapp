<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/main.css">
    <title>NcTranslator</title>
</head>
<body class="font-sans">
    <div class="flex-row py-5 w-full bg-blue-500">
        <div class="p-4">
        <h2 class=" text-4xl text-white">Nucleotide translator</h2>
        <p class=" text-xl text-white"> A simple tool to translate Nucleotide Sequences</p>
        </div>
    </div>


        <div class="flex flex-col min-h-screen w-full items-center bg-gradient-to-t from-blue-800 to-black">
            <div class="flex flex-col container m-3 p-5 pt-8 w-1/3 rounded-md bg-slate-400 align-middle">
            <h2 class="text-xl text-white p-2 mb-3"> Enter Fasta Sequence</h2>
            
                <form id="inputForm" action="/" method="POST" enctype="multipart/form-data">
                    <div class="flex flex-col">
                        <textarea id="sequence" name="sequence" rows="4" cols="50" required>{{input|safe}}</textarea>
                        <div class="flex flex-row justify-center">
                        <p class=" text-white p-2"> Reading Frame</p>
                            <div class="p-2"">
                            <select  id="frame" name="frame" default="{{frame}}">
                                <option value="0">0</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                            </select>
                            </div>
                        </div>
                        <div class="flex flex-row justify-center items-center p-2">
                        <input class="bg-blue-500 text-white py-2 px-3 m-3 rounded-sm hover:scale-110 transition-all ease-in-out" type="submit" name ="submit_button" value="Submit">
                        <input class="bg-blue-500 text-white py-2 px-3 m-3 rounded-sm hover:scale-110 transition-all ease-in-out" type="submit" name ="submit_button" value="Reset">
                        </div>
                    </div>
                </form>
            
            </div>
            
            {% if output %}
            <div class="flex flex-col container m-3 p-5 pt-8 w-1/3 rounded-md bg-slate-400 align-middle animate-in fade-in ">
                <h2 class="text-xl text-white p-2 mb-3"> Results</h2>
                <!-- Use safe filter to preserve newline characters -->
                {% for i in output %}
                    <div class="flex flex-col items-center">
                        <!-- <div class="flex flex-row items-center w-64"> -->
                            <p class="w-full break-words whitespace-normal bg-white"> >
                                {{ i[0] }} <br> {{i[1]}}
                            </p>
                        <!-- </div> -->
                        {% if not i[4] %}
                        <form action="/query" method="post">
                            <input type="hidden" id= 'seq' name="sequence" value="{{i[1]}}">
                            <input class="bg-blue-500 text-white py-2 px-3 m-3 rounded-sm animate-out fade-out-95 hover:scale-110 transition-all ease-in-out" type="submit" id="blast" value="BLAST?"></input>
                        </form>
                        {% endif %}
                        
                        {% if i[2] and i[3] %}
                            <p class="p-1 text-center text-white"> Estimated wait {{i[3]}} sec(s)</p>
                            <p class="p-1 text-center text-white"> Job ID : {{i[2]}} </p>
                        {% endif %}
                        {% if i[4] == 'TOOLONG' %}
                            <p class="px-2 text-center text-white"> NCBI servers seem to be busy. Click below to track your results on the NCBI website.</p>
                            <p class="bg-blue-500 text-white py-2 px-3 m-3 rounded-sm animate-out fade-out-95 hover:scale-110 transition-all ease-in-out"><a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Get&RID={{i[2]}}" target="_blank">Results</a></p>

                        {% elif i[4] == 'READY' %}
                            <p class="px-2 text-white"> Click below to view your results on the NCBI website.</p>
                            <p><a href="https://blast.ncbi.nlm.nih.gov/Blast.cgi?CMD=Get&RID={{i[2]}}" target="_blank">Results</a></p>
                        {% endif %}
                        
                    </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
    <script>
        // Clear form data on page reload
        window.onload = function() {
            document.getElementById("inputForm").reset();
            document.getElementById("seq").reset();
        };
    </script>
</body>
</html>